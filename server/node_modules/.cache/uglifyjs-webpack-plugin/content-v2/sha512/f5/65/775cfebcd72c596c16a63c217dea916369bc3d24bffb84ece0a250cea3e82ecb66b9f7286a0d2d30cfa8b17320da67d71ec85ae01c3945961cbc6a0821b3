{"code":"module.exports=function(e){var r={};function s(a){if(r[a])return r[a].exports;var n=r[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,s),n.l=!0,n.exports}return s.m=e,s.c=r,s.d=function(e,r,a){s.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:a})},s.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},s.t=function(e,r){if(1&r&&(e=s(e)),8&r)return e;if(4&r&&\"object\"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,\"default\",{enumerable:!0,value:e}),2&r&&\"string\"!=typeof e)for(var n in e)s.d(a,n,function(r){return e[r]}.bind(null,n));return a},s.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(r,\"a\",r),r},s.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},s.p=\"\",s(s.s=8)}([function(e,r,s){\"use strict\";Object.defineProperty(r,\"__esModule\",{value:!0}),r.authJwt=r.authLocal=r.myPassport=void 0;var a=o(s(3)),n=o(s(4)),t=s(9),i=o(s(5));function o(e){return e&&e.__esModule?e:{default:e}}const d=new n.default({usernameField:\"email\",passReqToCallback:!0},async(e,r,s,a)=>{try{const e=await i.default.findOne({email:r});return e?e.authenticateUser(s)?a(null,e):a(null,!1,{message:\"Wrong password.\"}):a(null,!1,{message:\"User does not exist!\"})}catch(e){return a(e,!1)}}),l={jwtFromRequest:t.ExtractJwt.fromAuthHeaderAsBearerToken(),secretOrKey:\"SecretKey\"},u=new t.Strategy(l,async(e,r)=>{try{const s=await i.default.findById(e._id);return r(null,s?s:!1)}catch(e){return r(e,!1)}});a.default.use(d),a.default.use(u);r.myPassport=a.default,r.authLocal=a.default.authenticate(\"local\",{session:!1},function(e,r,s){}),r.authJwt=a.default.authenticate(\"jwt\",{session:!1})},function(e,r){e.exports=require(\"mongoose\")},function(e,r){e.exports=require(\"express\")},function(e,r){e.exports=require(\"passport\")},function(e,r){e.exports=require(\"passport-local\")},function(e,r,s){\"use strict\";var a=d(s(1)),n=d(s(10)),t=d(s(11)),i=s(6),o=d(s(12));function d(e){return e&&e.__esModule?e:{default:e}}let l=new a.default.Schema({email:{type:String,unique:!0,required:[!0,\"Email address required!\"],validate:{validator:e=>n.default.isEmail(e)},message:\"{VALUE} is not a valid email.\"},name:{type:String,required:!0,max:100},password:{type:String},conversations:{type:[String]},friends:{type:[String]}});l.plugin(t.default,{message:\"{VALUE} already taken!\"}),l.pre(\"save\",function(e){return this.isModified(\"password\")&&(this.password=this._hashPassword(this.password)),e()}),l.methods={_hashPassword:e=>(0,i.hashSync)(e),authenticateUser(e){return(0,i.compareSync)(e,this.password)},createToken(){return o.default.sign({_id:this._id},\"SecretKey\")},toJSON(){return{_id:this._id,name:this.name,token:`JWT ${this.createToken()}`,email:this.email,friends:this.friends,conversations:this.conversations}}},e.exports=a.default.model(\"User\",l)},function(e,r){e.exports=require(\"bcrypt-nodejs\")},function(e,r){throw new Error('Module build failed (from ./node_modules/babel-loader/lib/index.js):\\nSyntaxError: /home/adam/needsFixing/DirectMessage/server/controllers/user.controller.js: Unexpected token, expected \",\" (60:74)\\n\\n\u001b[0m \u001b[90m 58 | \u001b[39m\\tconsole\u001b[33m.\u001b[39mlog(loggedInUserId)\u001b[0m\\n\u001b[0m \u001b[90m 59 | \u001b[39m\\tconsole\u001b[33m.\u001b[39mlog(\u001b[32m\"get convo\"\u001b[39m)\u001b[0m\\n\u001b[0m\u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 60 | \u001b[39m\\t\u001b[33mConversation\u001b[39m\u001b[33m.\u001b[39mfind({ user_ids \u001b[33m:\u001b[39m {$in\u001b[33m:\u001b[39m [\u001b[33mObjectId\u001b[39m(\u001b[32m\"5bfdab214d617208cdbb6850\"\u001b[39m] } }\u001b[33m,\u001b[39m \u001b[36mfunction\u001b[39m(err\u001b[33m,\u001b[39m conversations) {\u001b[0m\\n\u001b[0m \u001b[90m    | \u001b[39m\\t                                                                         \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\u001b[0m\\n\u001b[0m \u001b[90m 61 | \u001b[39m\\t\\t\u001b[36mif\u001b[39m (err) \u001b[36mreturn\u001b[39m handleError(err)\u001b[0m\\n\u001b[0m \u001b[90m 62 | \u001b[39m\\t\\tconsole\u001b[33m.\u001b[39mlog(conversations)\u001b[0m\\n\u001b[0m \u001b[90m 63 | \u001b[39m\\t\\tres\u001b[33m.\u001b[39msend(conversations)\u001b[0m\\n    at Parser.raise (/home/adam/needsFixing/DirectMessage/server/node_modules/@babel/parser/lib/index.js:3939:15)\\n    at Parser.unexpected (/home/adam/needsFixing/DirectMessage/server/node_modules/@babel/parser/lib/index.js:5248:16)\\n    at Parser.expect (/home/adam/needsFixing/DirectMessage/server/node_modules/@babel/parser/lib/index.js:5236:28)\\n    at Parser.parseCallExpressionArguments (/home/adam/needsFixing/DirectMessage/server/node_modules/@babel/parser/lib/index.js:6116:14)\\n    at Parser.parseSubscript (/home/adam/needsFixing/DirectMessage/server/node_modules/@babel/parser/lib/index.js:6029:32)\\n    at Parser.parseSubscripts (/home/adam/needsFixing/DirectMessage/server/node_modules/@babel/parser/lib/index.js:5944:19)\\n    at Parser.parseExprSubscripts (/home/adam/needsFixing/DirectMessage/server/node_modules/@babel/parser/lib/index.js:5934:17)\\n    at Parser.parseMaybeUnary (/home/adam/needsFixing/DirectMessage/server/node_modules/@babel/parser/lib/index.js:5903:21)\\n    at Parser.parseExprOps (/home/adam/needsFixing/DirectMessage/server/node_modules/@babel/parser/lib/index.js:5812:21)\\n    at Parser.parseMaybeConditional (/home/adam/needsFixing/DirectMessage/server/node_modules/@babel/parser/lib/index.js:5784:21)\\n    at Parser.parseMaybeAssign (/home/adam/needsFixing/DirectMessage/server/node_modules/@babel/parser/lib/index.js:5731:21)\\n    at Parser.parseExprListItem (/home/adam/needsFixing/DirectMessage/server/node_modules/@babel/parser/lib/index.js:7003:18)\\n    at Parser.parseExprList (/home/adam/needsFixing/DirectMessage/server/node_modules/@babel/parser/lib/index.js:6983:22)\\n    at Parser.parseExprAtom (/home/adam/needsFixing/DirectMessage/server/node_modules/@babel/parser/lib/index.js:6289:30)\\n    at Parser.parseExprSubscripts (/home/adam/needsFixing/DirectMessage/server/node_modules/@babel/parser/lib/index.js:5924:21)\\n    at Parser.parseMaybeUnary (/home/adam/needsFixing/DirectMessage/server/node_modules/@babel/parser/lib/index.js:5903:21)\\n    at Parser.parseExprOps (/home/adam/needsFixing/DirectMessage/server/node_modules/@babel/parser/lib/index.js:5812:21)\\n    at Parser.parseMaybeConditional (/home/adam/needsFixing/DirectMessage/server/node_modules/@babel/parser/lib/index.js:5784:21)\\n    at Parser.parseMaybeAssign (/home/adam/needsFixing/DirectMessage/server/node_modules/@babel/parser/lib/index.js:5731:21)\\n    at Parser.parseObjectProperty (/home/adam/needsFixing/DirectMessage/server/node_modules/@babel/parser/lib/index.js:6798:101)\\n    at Parser.parseObjPropValue (/home/adam/needsFixing/DirectMessage/server/node_modules/@babel/parser/lib/index.js:6823:99)\\n    at Parser.parseObj (/home/adam/needsFixing/DirectMessage/server/node_modules/@babel/parser/lib/index.js:6734:12)\\n    at Parser.parseExprAtom (/home/adam/needsFixing/DirectMessage/server/node_modules/@babel/parser/lib/index.js:6294:21)\\n    at Parser.parseExprSubscripts (/home/adam/needsFixing/DirectMessage/server/node_modules/@babel/parser/lib/index.js:5924:21)\\n    at Parser.parseMaybeUnary (/home/adam/needsFixing/DirectMessage/server/node_modules/@babel/parser/lib/index.js:5903:21)\\n    at Parser.parseExprOps (/home/adam/needsFixing/DirectMessage/server/node_modules/@babel/parser/lib/index.js:5812:21)\\n    at Parser.parseMaybeConditional (/home/adam/needsFixing/DirectMessage/server/node_modules/@babel/parser/lib/index.js:5784:21)\\n    at Parser.parseMaybeAssign (/home/adam/needsFixing/DirectMessage/server/node_modules/@babel/parser/lib/index.js:5731:21)\\n    at Parser.parseObjectProperty (/home/adam/needsFixing/DirectMessage/server/node_modules/@babel/parser/lib/index.js:6798:101)\\n    at Parser.parseObjPropValue (/home/adam/needsFixing/DirectMessage/server/node_modules/@babel/parser/lib/index.js:6823:99)\\n    at Parser.parseObj (/home/adam/needsFixing/DirectMessage/server/node_modules/@babel/parser/lib/index.js:6734:12)\\n    at Parser.parseExprAtom (/home/adam/needsFixing/DirectMessage/server/node_modules/@babel/parser/lib/index.js:6294:21)\\n    at Parser.parseExprSubscripts (/home/adam/needsFixing/DirectMessage/server/node_modules/@babel/parser/lib/index.js:5924:21)\\n    at Parser.parseMaybeUnary (/home/adam/needsFixing/DirectMessage/server/node_modules/@babel/parser/lib/index.js:5903:21)\\n    at Parser.parseExprOps (/home/adam/needsFixing/DirectMessage/server/node_modules/@babel/parser/lib/index.js:5812:21)\\n    at Parser.parseMaybeConditional (/home/adam/needsFixing/DirectMessage/server/node_modules/@babel/parser/lib/index.js:5784:21)')},function(e,r,s){\"use strict\";var a=s(0);const n=s(2),t=(s(13),s(14)),i=(s(15)(t),s(16)),o=s(3),d=(s(4).Strategy,s(17),s(6),s(1)),l=s(18),u=s(19);d.connect(\"mongodb://localhost/ChatAppDB\");const m=n();m.use(l()),m.use(i.urlencoded({extended:!0})),m.use(i.json()),m.use(o.initialize()),m.set(\"view engine\",\"ejs\"),m.use(\"/user\",u),m.get(\"/\",(e,r)=>{r.send(\"You got home page!\\n\")}),m.get(\"/login\",(e,r)=>{r.render(\"login\",{})}),m.post(\"/login\",(e,r,s)=>{o.authenticate(\"local\",(a,n,t)=>t?r.send(t.message):a?s(a):n?void e.login(n,e=>e?s(e):r.redirect(\"/authrequired\")):r.redirect(\"/login\"))(e,r,s)}),m.get(\"/authrequired\",(e,r)=>{e.isAuthenticated()?r.send(\"you hit the authentication endpoint\\n\"):r.redirect(\"/\")}),m.get(\"/private\",a.authJwt,(e,r)=>{r.send(\"Private info!\")}),m.use(function(e,r,s,a){e.errors?e.errors[0]?'\"email\" must be a valid email'==e.errors[0].messages[0]?s.status(400).json(r.body.email+e.errors[0].messages[0].slice(7)):s.status(400).json(e.errors[0].messages):e.errors.email&&s.status(400).json(e.errors.email.message):s.status(400).json(e)}),m.listen(3e3,()=>{console.log(\"Listening on localhost:3000...\")}),e.exports=m},function(e,r){e.exports=require(\"passport-jwt\")},function(e,r){e.exports=require(\"validator\")},function(e,r){e.exports=require(\"mongoose-unique-validator\")},function(e,r){e.exports=require(\"jsonwebtoken\")},function(e,r){e.exports=require(\"uuid/v4\")},function(e,r){e.exports=require(\"express-session\")},function(e,r){e.exports=require(\"session-file-store\")},function(e,r){e.exports=require(\"body-parser\")},function(e,r){e.exports=require(\"axios\")},function(e,r){e.exports=require(\"cors\")},function(e,r,s){\"use strict\";var a=i(s(20)),n=i(s(21)),t=function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,s):{};a.get||a.set?Object.defineProperty(r,s,a):r[s]=e[s]}return r.default=e,r}(s(7));s(0);function i(e){return e&&e.__esModule?e:{default:e}}const o=s(2).Router(),d=s(7);o.post(\"/register\",(0,a.default)(n.default.loginUser),t.registerUser),o.post(\"/login\",t.loginUser),o.get(\"/show/:query\",d.showUser),o.post(\"/add_friend\",t.addFriend),o.get(\"/get_friends/:user_id\",t.getFriends),o.get(\"/get_conversations/:user_id\",t.getConversations),e.exports=o},function(e,r){e.exports=require(\"express-validation\")},function(e,r,s){\"use strict\";Object.defineProperty(r,\"__esModule\",{value:!0});var a=function(e){return e&&e.__esModule?e:{default:e}}(s(22));r.default={loginUser:{body:{email:a.default.string().email().required(),password:a.default.string().required(),name:a.default.string().required()}}}},function(e,r){e.exports=require(\"joi\")}]);","extractedComments":[]}